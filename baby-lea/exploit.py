#!/usr/bin/env python3
import hashlib
from base64 import b64encode, b64decode
from pwn import *

r = remote("bamboofox.cs.nctu.edu.tw", 58789)

token = b"user=someone\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\xc0user=admin"
auth = b"e43ae12ce0024abef5a376eebfc2ac7fc5a73d6be3a4b871f203f53e12191b5c"

r.sendlineafter("input your token: ", b64encode(token))
r.sendlineafter("input your authentication code: ", auth)

print(r.recvline().decode('utf-8'))
